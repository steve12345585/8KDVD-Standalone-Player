From 528be758326ac8c1caaf33bbd47615f2df00f21f Mon Sep 17 00:00:00 2001
From: Francois Cartegnie <fcvlcdev@free.fr>
Date: Mon, 18 Nov 2024 13:20:34 +0700
Subject: [PATCH 3/4] dvbpsi_packet_push: check section pointers field

---
 src/dvbpsi.c | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/src/dvbpsi.c b/src/dvbpsi.c
index 0c8c440..6b5641a 100644
--- a/src/dvbpsi.c
+++ b/src/dvbpsi.c
@@ -328,6 +328,8 @@ bool dvbpsi_packet_push(dvbpsi_t *p_dvbpsi, uint8_t* p_data)
     {
         p_new_pos = p_payload_pos + *p_payload_pos + 1;
         p_payload_pos += 1;
+	if(p_payload_pos >= p_data_end || p_new_pos >= p_data_end)
+	    return false;
     }
 
     p_section = p_decoder->p_current_section;
-- 
2.48.1

